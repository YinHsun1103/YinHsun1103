import streamlit as st
import pandas as pd
import numpy as np
from PIL import Image
import random

# 初始化状态信息
state = st.session_state
if "selected_tab" not in state:
    state.selected_tab = "Steamlit练习"

# 创建选项卡
tabs = ["Steamlit练习", "HomeWork1"]
state.selected_tab = st.sidebar.radio("选择页面", tabs, index=tabs.index(state.selected_tab))

# 页面内容
if state.selected_tab == "Steamlit练习":
    st.title("Steamlit练习")

    st.title('Hello, streamlit！我的第一支web應用程式開發!!!')
    st.write('我是一個字串')
    K = 9999
    st.write(K)

    dataframe = pd.DataFrame(np.random.randn(10, 20), columns=[f"col_{i}" for i in range(20)])
    st.write(dataframe)

    st.markdown("# 這是一個示例 Streamlit 網頁")
    st.markdown('''Streamlit can write text in pretty colors.''')
    st.markdown("Here's a bouquet 🌸")

    st.title("歡迎來到我的網站")
    st.header("這是一個標頭")

    st.caption("這是一張美麗的圖片")
    st.code("print('Hello, Streamlit!')")

    st.latex(r"e^{i\pi} + 1 = 0")

    st.write("這是一個分隔線")
    st.divider()

    df = pd.DataFrame(np.random.randn(10, 10), columns=("col %d" % i for i in range(10)))
    st.dataframe(df)

    st.metric(label="溫度", value="30 °C", delta="1.2 °C")

    # 顯示隨機表格和地圖
    df_boundaries = pd.DataFrame({
        "區域": ["中正區", "大同區"],
        "西經度": [121.506623, 121.511034],
        "東經度": [121.529235, 121.525196],
        "南緯度": [25.032883, 25.062731],
        "北緯度": [25.041144, 25.066231],
    })
    df_boundaries['人口數'] = np.random.randint(100, 1000, len(df_boundaries))
    st.map(df_boundaries[['南緯度', '西經度']])

    # 下載功能
    data = pd.DataFrame({'Column1': [1, 2, 3], 'Column2': ['A', 'B', 'C']})
    csv = data.to_csv().encode('utf-8')
    st.download_button(label="下載CSV", data=csv, file_name='data.csv', mime='text/csv')

elif state.selected_tab == "HomeWork1":
    st.title("HomeWork1")

    # 上傳文件部分
    file = st.file_uploader("上傳CSV文件", type=['csv'])
    if file is not None:
        df = pd.read_csv(file)
        st.write(df)

        # 繪圖
        selected_column = st.selectbox("選擇要繪製的列", df.columns)
        st.line_chart(df[selected_column])
